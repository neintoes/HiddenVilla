#pragma checksum "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "0ff76c8b54cf1b5dde873e083cfa9a1bf8d727f3"
// <auto-generated/>
#pragma warning disable 1591
namespace HiddenVilla_Server.Pages.Amenity
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using HiddenVilla_Server;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using HiddenVilla_Server.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using HiddenVilla_Server.Pages.LearnBlazorPages.LearnBlazorComponents;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using HiddenVilla_Server.Model;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using HiddenVilla_Server.Helper;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\_Imports.razor"
using Blazored.TextEditor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
using Business.Repository.IRepoosiory;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
using Models;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/amenity/create")]
    [Microsoft.AspNetCore.Components.RouteAttribute("/amenity/edit/{HotelRoomAmenityId:int}")]
    public partial class AmenityUpsert : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenElement(0, "div");
            __builder.AddAttribute(1, "class", "row mt-2 mb-5");
            __builder.OpenElement(2, "h3");
            __builder.AddAttribute(3, "class", "card-title text-info mb-3 ml-3");
#nullable restore
#line 10 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
__builder.AddContent(4, title);

#line default
#line hidden
#nullable disable
            __builder.AddContent(5, " Hotel Room");
            __builder.CloseElement();
            __builder.AddMarkupContent(6, "\r\n        ");
            __builder.OpenElement(7, "div");
            __builder.AddAttribute(8, "class", "col-md-12");
            __builder.OpenElement(9, "div");
            __builder.AddAttribute(10, "class", "card");
            __builder.OpenElement(11, "div");
            __builder.AddAttribute(12, "class", "card-body");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Forms.EditForm>(13);
            __builder.AddAttribute(14, "Model", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Object>(
#nullable restore
#line 14 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                      amenity

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(15, "OnValidSubmit", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Forms.EditContext>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Forms.EditContext>(this, 
#nullable restore
#line 14 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                              HandleHotelAmenityUpsert

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(16, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment<Microsoft.AspNetCore.Components.Forms.EditContext>)((context) => (__builder2) => {
                __builder2.OpenComponent<Microsoft.AspNetCore.Components.Forms.DataAnnotationsValidator>(17);
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(18, "\r\n                        ");
                __builder2.OpenElement(19, "div");
                __builder2.AddAttribute(20, "class", "form-group");
                __builder2.AddMarkupContent(21, "<label>Amenity Type:</label>\r\n                            ");
                __builder2.OpenComponent<Microsoft.AspNetCore.Components.Forms.InputText>(22);
                __builder2.AddAttribute(23, "Value", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 18 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                    amenity.Name

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(24, "ValueChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.String>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.String>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => amenity.Name = __value, amenity.Name))));
                __builder2.AddAttribute(25, "ValueExpression", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Linq.Expressions.Expression<System.Func<System.String>>>(() => amenity.Name));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(26, "\r\n                            ");
                __Blazor.HiddenVilla_Server.Pages.Amenity.AmenityUpsert.TypeInference.CreateValidationMessage_0(__builder2, 27, 28, 
#nullable restore
#line 19 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                    () =>amenity.Name

#line default
#line hidden
#nullable disable
                );
                __builder2.CloseElement();
                __builder2.AddMarkupContent(29, "\r\n                        ");
                __builder2.OpenElement(30, "div");
                __builder2.AddAttribute(31, "class", "form-group");
                __builder2.AddMarkupContent(32, "<label>Times Available:</label>\r\n                            ");
                __builder2.OpenComponent<Microsoft.AspNetCore.Components.Forms.InputText>(33);
                __builder2.AddAttribute(34, "Value", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 23 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                    amenity.Timing

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(35, "ValueChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.String>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.String>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => amenity.Timing = __value, amenity.Timing))));
                __builder2.AddAttribute(36, "ValueExpression", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Linq.Expressions.Expression<System.Func<System.String>>>(() => amenity.Timing));
                __builder2.CloseComponent();
                __builder2.CloseElement();
                __builder2.AddMarkupContent(37, "\r\n                        ");
                __builder2.OpenElement(38, "div");
                __builder2.AddAttribute(39, "class", "form-group");
                __builder2.AddMarkupContent(40, "<label>Icon Styling:</label>\r\n                            ");
                __builder2.OpenComponent<Microsoft.AspNetCore.Components.Forms.InputText>(41);
                __builder2.AddAttribute(42, "Value", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 27 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                    amenity.IconStyle

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(43, "ValueChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.String>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.String>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => amenity.IconStyle = __value, amenity.IconStyle))));
                __builder2.AddAttribute(44, "ValueExpression", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Linq.Expressions.Expression<System.Func<System.String>>>(() => amenity.IconStyle));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(45, "\r\n                            ");
                __Blazor.HiddenVilla_Server.Pages.Amenity.AmenityUpsert.TypeInference.CreateValidationMessage_1(__builder2, 46, 47, 
#nullable restore
#line 28 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                    ()=>amenity.IconStyle

#line default
#line hidden
#nullable disable
                );
                __builder2.CloseElement();
                __builder2.AddMarkupContent(48, "\r\n\r\n\r\n                        ");
                __builder2.OpenElement(49, "div");
                __builder2.AddAttribute(50, "class", "form-group");
                __builder2.AddAttribute(51, "style", "height:250px;");
                __builder2.AddMarkupContent(52, "<label>Amenity Description</label>\r\n                        ");
                __builder2.OpenComponent<Blazored.TextEditor.BlazoredTextEditor>(53);
                __builder2.AddAttribute(54, "Placeholder", "Please enter a description of the amenity");
                __builder2.AddAttribute(55, "ToolbarContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenElement(56, "select");
                    __builder3.AddAttribute(57, "class", "ql-header");
                    __builder3.OpenElement(58, "option");
                    __builder3.AddAttribute(59, "selected");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(60, "\r\n                                    ");
                    __builder3.OpenElement(61, "option");
                    __builder3.AddAttribute(62, "value", "1");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(63, "\r\n                                    ");
                    __builder3.OpenElement(64, "option");
                    __builder3.AddAttribute(65, "value", "2");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(66, "\r\n                                    ");
                    __builder3.OpenElement(67, "option");
                    __builder3.AddAttribute(68, "value", "3");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(69, "\r\n                                    ");
                    __builder3.OpenElement(70, "option");
                    __builder3.AddAttribute(71, "value", "4");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(72, "\r\n                                    ");
                    __builder3.OpenElement(73, "option");
                    __builder3.AddAttribute(74, "value", "5");
                    __builder3.CloseElement();
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(75, "\r\n                                ");
                    __builder3.AddMarkupContent(76, @"<span class=""ql-formats""><button class=""ql-bold""></button>
                                    <button class=""ql-italic""></button>
                                    <button class=""ql-underline""></button>
                                    <button class=""ql-strike""></button></span>
                                ");
                    __builder3.AddMarkupContent(77, "<span class=\"ql-formats\"><select class=\"ql-color\"></select>\r\n                                    <select class=\"ql-background\"></select></span>\r\n                                ");
                    __builder3.AddMarkupContent(78, "<span class=\"ql-formats\"><button class=\"ql-list\" value=\"ordered\"></button>\r\n                                    <button class=\"ql-list\" value=\"bullet\"></button></span>\r\n                                ");
                    __builder3.AddMarkupContent(79, "<span class=\"ql-formats\"><button class=\"ql-link\"></button></span>");
                }
                ));
                __builder2.AddAttribute(80, "EditorContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
#nullable restore
#line 67 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
__builder3.AddContent(81, (MarkupString)@preExistingAmenityDescription);

#line default
#line hidden
#nullable disable
                }
                ));
                __builder2.AddComponentReferenceCapture(82, (__value) => {
#nullable restore
#line 38 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
                                                   QuillHtml = (Blazored.TextEditor.BlazoredTextEditor)__value;

#line default
#line hidden
#nullable disable
                }
                );
                __builder2.CloseComponent();
                __builder2.CloseElement();
                __builder2.AddMarkupContent(83, "\r\n                        ");
                __builder2.OpenElement(84, "div");
                __builder2.AddAttribute(85, "class", "form-group");
                __builder2.AddAttribute(86, "style", "padding-top:70px;");
                __builder2.OpenElement(87, "button");
                __builder2.AddAttribute(88, "class", "btn btn-primary");
#nullable restore
#line 72 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
__builder2.AddContent(89, title);

#line default
#line hidden
#nullable disable
                __builder2.AddContent(90, " Amenity");
                __builder2.CloseElement();
                __builder2.AddMarkupContent(91, "\r\n                            ");
                __builder2.OpenComponent<Microsoft.AspNetCore.Components.Routing.NavLink>(92);
                __builder2.AddAttribute(93, "href", "amenity");
                __builder2.AddAttribute(94, "class", "btn btn-secondary");
                __builder2.AddAttribute(95, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.AddContent(96, "Back to Index");
                }
                ));
                __builder2.CloseComponent();
                __builder2.CloseElement();
            }
            ));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 81 "C:\Users\antho\source\repos\HiddenVilla\HiddenVilla_Server\Pages\Amenity\AmenityUpsert.razor"
       
    [Parameter] 
    public int? HotelRoomAmenityId{ get; set; }

    private string title { get; set; }
    //preExisting name for checking for name uniqueness (if the name has been changed fromt he pre existing name)
    private string preExistingAmenityName { get; set; }
    //preExisiting details for rendering into the quill text editor. (and avoiding that heinous infinite loop suggested in tutorial)
    private string preExistingAmenityDescription{ get; set; }
    HotelRoomAmenityDTO amenity { get; set; } = new HotelRoomAmenityDTO();

    //Quill variables
    BlazoredTextEditor QuillHtml;
    string quillHtmlContent;


    protected async override Task OnInitializedAsync()
    {
        if(HotelRoomAmenityId == null)
        {
            //CREATE page initialisation
            title = "Create";
            amenity = new HotelRoomAmenityDTO();
        }
        else
        {
            //EDIT page initialisation
            title = "Edit";
            amenity = await HotelRoomAmenityRepository.GetHotelRoomAmenity(HotelRoomAmenityId.Value);
            preExistingAmenityName = amenity.Name;
            preExistingAmenityDescription = amenity.Description;
        }
    }

    private async Task HandleHotelAmenityUpsert()
    {
        try
        {
            if(amenity.Name != preExistingAmenityName || preExistingAmenityName == null)
            {

                var uniqueNameCheck = await HotelRoomAmenityRepository.IsHotelRoomAmenityUnique(amenity.Name);
                if(uniqueNameCheck != null)
                {
                    //If the name of the amenity has been taken..
                    await ErrorPress("Uh oh! There has been an error! This amenity name has already been taken.", "Please rename your amenity and try uploading it again.");
                    return;
                }

                amenity.Description = await QuillHtml.GetHTML(); 
                if(title == "Create")
                {
                    //Handle Create method
                    var createdAmenity = await HotelRoomAmenityRepository.CreateHotelRoomAmenity(amenity);
                    await SuccessPress(amenity.Name + " has successfully been entered into the system.");
                }
                else
                {
                    //Handle Update method
                    var updatedAmenity = await HotelRoomAmenityRepository.UpdateHotelRoomAmenity(HotelRoomAmenityId.Value,amenity);
                    await SuccessPress(amenity.Name + " has successfully been updated in the system.");
                }
                NavigationManager.NavigateTo("amenity");

            }
        } catch(Exception ex)
        {
            throw new Exception(ex.ToString());
        }

    }

    //QuillTextEditor Methods
    public async void GetHTML()
    {
        quillHtmlContent = await this.QuillHtml.GetHTML();
        StateHasChanged();
    }

    public void SetHTML()
    {
        try
        {
            if (!string.IsNullOrEmpty(amenity.Description))
            {
                this.QuillHtml.LoadHTMLContent(amenity.Description);
                StateHasChanged();
            }
        } catch(Exception ex)
        {
            throw new Exception(ex.ToString());
        }
    }

    //JS button alerts
    private async Task ErrorPress(string inputMessage, string inputMessageTwo)
    {
        await JSRuntime.SwalError(inputMessage, inputMessageTwo);
    }

        private async Task SuccessPress(string inputMessage)
    {
        await JSRuntime.ToastrSuccess(inputMessage);
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IHotelRoomAmenityRepository HotelRoomAmenityRepository { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
    }
}
namespace __Blazor.HiddenVilla_Server.Pages.Amenity.AmenityUpsert
{
    #line hidden
    internal static class TypeInference
    {
        public static void CreateValidationMessage_0<TValue>(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder, int seq, int __seq0, global::System.Linq.Expressions.Expression<global::System.Func<TValue>> __arg0)
        {
        __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Forms.ValidationMessage<TValue>>(seq);
        __builder.AddAttribute(__seq0, "For", __arg0);
        __builder.CloseComponent();
        }
        public static void CreateValidationMessage_1<TValue>(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder, int seq, int __seq0, global::System.Linq.Expressions.Expression<global::System.Func<TValue>> __arg0)
        {
        __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Forms.ValidationMessage<TValue>>(seq);
        __builder.AddAttribute(__seq0, "For", __arg0);
        __builder.CloseComponent();
        }
    }
}
#pragma warning restore 1591
